"use strict";(self.webpackChunksalux_ds_lib=self.webpackChunksalux_ds_lib||[]).push([[350],{"./node_modules/ngx-mask/fesm2022/ngx-mask.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Dw:()=>provideNgxMask,Zr:()=>NgxMaskDirective});var MaskExpression,C_Users_thiago_bloomfield_Documents_SaluxTech_sx_lib_front_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),_angular_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),_angular_forms__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs");!function(MaskExpression){MaskExpression.SEPARATOR="separator",MaskExpression.PERCENT="percent",MaskExpression.IP="IP",MaskExpression.CPF_CNPJ="CPF_CNPJ",MaskExpression.MONTH="M",MaskExpression.MONTHS="M0",MaskExpression.MINUTE="m",MaskExpression.HOUR="h",MaskExpression.HOURS="H",MaskExpression.MINUTES="m0",MaskExpression.HOURS_HOUR="Hh",MaskExpression.SECONDS="s0",MaskExpression.HOURS_MINUTES_SECONDS="Hh:m0:s0",MaskExpression.EMAIL_MASK="A*@A*.A*",MaskExpression.HOURS_MINUTES="Hh:m0",MaskExpression.MINUTES_SECONDS="m0:s0",MaskExpression.DAYS_MONTHS_YEARS="d0/M0/0000",MaskExpression.DAYS_MONTHS="d0/M0",MaskExpression.DAYS="d0",MaskExpression.DAY="d",MaskExpression.SECOND="s",MaskExpression.LETTER_S="S",MaskExpression.DOT=".",MaskExpression.COMMA=",",MaskExpression.CURLY_BRACKETS_LEFT="{",MaskExpression.CURLY_BRACKETS_RIGHT="}",MaskExpression.MINUS="-",MaskExpression.OR="||",MaskExpression.HASH="#",MaskExpression.EMPTY_STRING="",MaskExpression.SYMBOL_STAR="*",MaskExpression.SYMBOL_QUESTION="?",MaskExpression.SLASH="/",MaskExpression.WHITE_SPACE=" ",MaskExpression.NUMBER_ZERO="0",MaskExpression.NUMBER_NINE="9",MaskExpression.BACKSPACE="Backspace",MaskExpression.DELETE="Delete",MaskExpression.ARROW_LEFT="ArrowLeft",MaskExpression.ARROW_UP="ArrowUp",MaskExpression.DOUBLE_ZERO="00"}(MaskExpression||(MaskExpression={}));const NGX_MASK_CONFIG=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken("ngx-mask config"),NEW_CONFIG=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken("new ngx-mask config"),INITIAL_CONFIG=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken("initial ngx-mask config"),initialConfig={suffix:"",prefix:"",thousandSeparator:" ",decimalMarker:[".",","],clearIfNotMatch:!1,showMaskTyped:!1,instantPrefix:!1,placeHolderCharacter:"_",dropSpecialCharacters:!0,hiddenInput:!1,shownMaskExpression:"",separatorLimit:"",allowNegativeNumbers:!1,validation:!0,specialCharacters:["-","/","(",")",".",":"," ","+",",","@","[","]",'"',"'"],leadZeroDateTime:!1,apm:!1,leadZero:!1,keepCharacterPositions:!1,triggerOnMaskChange:!1,inputTransformFn:value=>value,outputTransformFn:value=>value,maskFilled:new _angular_core__WEBPACK_IMPORTED_MODULE_0__.EventEmitter,patterns:{0:{pattern:new RegExp("\\d")},9:{pattern:new RegExp("\\d"),optional:!0},X:{pattern:new RegExp("\\d"),symbol:"*"},A:{pattern:new RegExp("[a-zA-Z0-9]")},S:{pattern:new RegExp("[a-zA-Z]")},U:{pattern:new RegExp("[A-Z]")},L:{pattern:new RegExp("[a-z]")},d:{pattern:new RegExp("\\d")},m:{pattern:new RegExp("\\d")},M:{pattern:new RegExp("\\d")},H:{pattern:new RegExp("\\d")},h:{pattern:new RegExp("\\d")},s:{pattern:new RegExp("\\d")}}},timeMasks=[MaskExpression.HOURS_MINUTES_SECONDS,MaskExpression.HOURS_MINUTES,MaskExpression.MINUTES_SECONDS],withoutValidation=[MaskExpression.PERCENT,MaskExpression.HOURS_HOUR,MaskExpression.SECONDS,MaskExpression.MINUTES,MaskExpression.SEPARATOR,MaskExpression.DAYS_MONTHS_YEARS,MaskExpression.DAYS_MONTHS,MaskExpression.DAYS,MaskExpression.MONTHS];class NgxMaskApplierService{_config=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(NGX_MASK_CONFIG);dropSpecialCharacters=this._config.dropSpecialCharacters;hiddenInput=this._config.hiddenInput;clearIfNotMatch=this._config.clearIfNotMatch;specialCharacters=this._config.specialCharacters;patterns=this._config.patterns;prefix=this._config.prefix;suffix=this._config.suffix;thousandSeparator=this._config.thousandSeparator;decimalMarker=this._config.decimalMarker;customPattern;showMaskTyped=this._config.showMaskTyped;placeHolderCharacter=this._config.placeHolderCharacter;validation=this._config.validation;separatorLimit=this._config.separatorLimit;allowNegativeNumbers=this._config.allowNegativeNumbers;leadZeroDateTime=this._config.leadZeroDateTime;leadZero=this._config.leadZero;apm=this._config.apm;inputTransformFn=this._config.inputTransformFn;outputTransformFn=this._config.outputTransformFn;keepCharacterPositions=this._config.keepCharacterPositions;instantPrefix=this._config.instantPrefix;_shift=new Set;plusOnePosition=!1;maskExpression="";actualValue="";showKeepCharacterExp="";shownMaskExpression="";deletedSpecialCharacter=!1;ipError;cpfCnpjError;applyMask(inputValue,maskExpression,position=0,justPasted=!1,backspaced=!1,cb=()=>{}){if(!maskExpression||"string"!=typeof inputValue)return MaskExpression.EMPTY_STRING;let cursor=0,result="",multi=!1,backspaceShift=!1,shift=1,stepBack=!1,processedValue=inputValue,processedPosition=position;processedValue.slice(0,this.prefix.length)===this.prefix&&(processedValue=processedValue.slice(this.prefix.length,processedValue.length)),this.suffix&&processedValue.length>0&&(processedValue=this.checkAndRemoveSuffix(processedValue)),"("===processedValue&&this.prefix&&(processedValue="");const inputArray=processedValue.toString().split(MaskExpression.EMPTY_STRING);if(this.allowNegativeNumbers&&processedValue.slice(cursor,cursor+1)===MaskExpression.MINUS&&(result+=processedValue.slice(cursor,cursor+1)),maskExpression===MaskExpression.IP){const valuesIP=processedValue.split(MaskExpression.DOT);this.ipError=this._validIP(valuesIP),maskExpression="099.099.099.099"}const arr=[];for(let i=0;i<processedValue.length;i++)processedValue[i]?.match("\\d")&&arr.push(processedValue[i]??MaskExpression.EMPTY_STRING);if(maskExpression===MaskExpression.CPF_CNPJ&&(this.cpfCnpjError=11!==arr.length&&14!==arr.length,maskExpression=arr.length>11?"00.000.000/0000-00":"000.000.000-00"),maskExpression.startsWith(MaskExpression.PERCENT)){if(processedValue.match("[a-z]|[A-Z]")||processedValue.match(/[-!$%^&*()_+|~=`{}\[\]:";'<>?,\/.]/)&&!backspaced){processedValue=this._stripToDecimal(processedValue);const precision=this.getPrecision(maskExpression);processedValue=this.checkInputPrecision(processedValue,precision,this.decimalMarker)}const decimalMarker="string"==typeof this.decimalMarker?this.decimalMarker:MaskExpression.DOT;if(processedValue.indexOf(decimalMarker)>0&&!this.percentage(processedValue.substring(0,processedValue.indexOf(decimalMarker)))){let base=processedValue.substring(0,processedValue.indexOf(decimalMarker)-1);this.allowNegativeNumbers&&processedValue.slice(cursor,cursor+1)===MaskExpression.MINUS&&!backspaced&&(base=processedValue.substring(0,processedValue.indexOf(decimalMarker))),processedValue=`${base}${processedValue.substring(processedValue.indexOf(decimalMarker),processedValue.length)}`}let value="";value=this.allowNegativeNumbers&&processedValue.slice(cursor,cursor+1)===MaskExpression.MINUS?`${MaskExpression.MINUS}${processedValue.slice(cursor+1,cursor+processedValue.length)}`:processedValue,result=this.percentage(value)?this._splitPercentZero(processedValue):this._splitPercentZero(processedValue.substring(0,processedValue.length-1))}else if(maskExpression.startsWith(MaskExpression.SEPARATOR)){(processedValue.match("[wа-яА-Я]")||processedValue.match("[ЁёА-я]")||processedValue.match("[a-z]|[A-Z]")||processedValue.match(/[-@#!$%\\^&*()_£¬'+|~=`{}\]:";<>.?/]/)||processedValue.match("[^A-Za-z0-9,]"))&&(processedValue=this._stripToDecimal(processedValue));const precision=this.getPrecision(maskExpression);let decimalMarker=this.decimalMarker;if(Array.isArray(this.decimalMarker)&&(decimalMarker=this.actualValue.includes(this.decimalMarker[0])||this.actualValue.includes(this.decimalMarker[1])?this.actualValue.includes(this.decimalMarker[0])?this.decimalMarker[0]:this.decimalMarker[1]:this.decimalMarker.find((dm=>dm!==this.thousandSeparator))),backspaced){const{decimalMarkerIndex,nonZeroIndex}=this._findFirstNonZeroAndDecimalIndex(processedValue,decimalMarker),zeroIndexMinus=processedValue[0]===MaskExpression.MINUS,zeroIndexNumberZero=processedValue[0]===MaskExpression.NUMBER_ZERO,zeroIndexDecimalMarker=processedValue[0]===decimalMarker,firstIndexDecimalMarker=processedValue[1]===decimalMarker;(zeroIndexDecimalMarker&&!nonZeroIndex||zeroIndexMinus&&firstIndexDecimalMarker&&!nonZeroIndex||zeroIndexNumberZero&&!decimalMarkerIndex&&!nonZeroIndex)&&(processedValue=MaskExpression.NUMBER_ZERO),decimalMarkerIndex&&nonZeroIndex&&zeroIndexMinus&&1===processedPosition&&(decimalMarkerIndex<nonZeroIndex||decimalMarkerIndex>nonZeroIndex)&&(processedValue=MaskExpression.MINUS+processedValue.slice(nonZeroIndex)),!decimalMarkerIndex&&nonZeroIndex&&processedValue.length>nonZeroIndex&&(processedValue=zeroIndexMinus?MaskExpression.MINUS+processedValue.slice(nonZeroIndex):processedValue.slice(nonZeroIndex)),decimalMarkerIndex&&nonZeroIndex&&0===processedPosition&&(decimalMarkerIndex<nonZeroIndex&&(processedValue=processedValue.slice(decimalMarkerIndex-1)),decimalMarkerIndex>nonZeroIndex&&(processedValue=processedValue.slice(nonZeroIndex)))}0===precision?processedValue=this.allowNegativeNumbers?processedValue.length>2&&processedValue[0]===MaskExpression.MINUS&&processedValue[1]===MaskExpression.NUMBER_ZERO&&processedValue[2]!==this.thousandSeparator&&processedValue[2]!==MaskExpression.COMMA&&processedValue[2]!==MaskExpression.DOT?"-"+processedValue.slice(2,processedValue.length):processedValue[0]===MaskExpression.NUMBER_ZERO&&processedValue.length>1&&processedValue[1]!==this.thousandSeparator&&processedValue[1]!==MaskExpression.COMMA&&processedValue[1]!==MaskExpression.DOT?processedValue.slice(1,processedValue.length):processedValue:processedValue.length>1&&processedValue[0]===MaskExpression.NUMBER_ZERO&&processedValue[1]!==this.thousandSeparator&&processedValue[1]!==MaskExpression.COMMA&&processedValue[1]!==MaskExpression.DOT?processedValue.slice(1,processedValue.length):processedValue:(processedValue[0]===decimalMarker&&processedValue.length>1&&!backspaced&&(processedValue=MaskExpression.NUMBER_ZERO+processedValue.slice(0,processedValue.length+1),this.plusOnePosition=!0),processedValue[0]!==MaskExpression.NUMBER_ZERO||processedValue[1]===decimalMarker||processedValue[1]===this.thousandSeparator||backspaced||(processedValue=processedValue.length>1?processedValue.slice(0,1)+decimalMarker+processedValue.slice(1,processedValue.length+1):processedValue,this.plusOnePosition=!0),!this.allowNegativeNumbers||backspaced||processedValue[0]!==MaskExpression.MINUS||processedValue[1]!==decimalMarker&&processedValue[1]!==MaskExpression.NUMBER_ZERO||(processedValue=processedValue[1]===decimalMarker&&processedValue.length>2?processedValue.slice(0,1)+MaskExpression.NUMBER_ZERO+processedValue.slice(1,processedValue.length):processedValue[1]===MaskExpression.NUMBER_ZERO&&processedValue.length>2&&processedValue[2]!==decimalMarker?processedValue.slice(0,2)+decimalMarker+processedValue.slice(2,processedValue.length):processedValue,this.plusOnePosition=!0));const thousandSeparatorCharEscaped=this._charToRegExpExpression(this.thousandSeparator);let invalidChars='@#!$%^&*()_+|~=`{}\\[\\]:\\s,\\.";<>?\\/'.replace(thousandSeparatorCharEscaped,"");if(Array.isArray(this.decimalMarker))for(const marker of this.decimalMarker)invalidChars=invalidChars.replace(this._charToRegExpExpression(marker),MaskExpression.EMPTY_STRING);else invalidChars=invalidChars.replace(this._charToRegExpExpression(this.decimalMarker),"");const invalidCharRegexp=new RegExp("["+invalidChars+"]");processedValue.match(invalidCharRegexp)&&(processedValue=processedValue.substring(0,processedValue.length-1)),processedValue=this.checkInputPrecision(processedValue,precision,this.decimalMarker);const strForSep=processedValue.replace(new RegExp(thousandSeparatorCharEscaped,"g"),"");result=this._formatWithSeparators(strForSep,this.thousandSeparator,this.decimalMarker,precision);const commaShift=result.indexOf(MaskExpression.COMMA)-processedValue.indexOf(MaskExpression.COMMA),shiftStep=result.length-processedValue.length,backspacedDecimalMarkerWithSeparatorLimit=backspaced&&result.length<inputValue.length&&this.separatorLimit;if((result[processedPosition-1]===this.thousandSeparator||result[processedPosition-this.prefix.length])&&this.prefix&&backspaced)processedPosition-=1;else if(shiftStep>0&&result[processedPosition]!==this.thousandSeparator||backspacedDecimalMarkerWithSeparatorLimit){backspaceShift=!0;let _shift=0;do{this._shift.add(processedPosition+_shift),_shift++}while(_shift<shiftStep)}else result[processedPosition-1]===this.thousandSeparator||-4===shiftStep||-3===shiftStep||result[processedPosition]===this.thousandSeparator?(this._shift.clear(),this._shift.add(processedPosition-1)):0!==commaShift&&processedPosition>0&&!(result.indexOf(MaskExpression.COMMA)>=processedPosition&&processedPosition>3)||!(result.indexOf(MaskExpression.DOT)>=processedPosition&&processedPosition>3)&&shiftStep<=0?(this._shift.clear(),backspaceShift=!0,shift=shiftStep,processedPosition+=shiftStep,this._shift.add(processedPosition)):this._shift.clear()}else for(let i=0,inputSymbol=inputArray[0];i<inputArray.length&&cursor!==maskExpression.length;i++,inputSymbol=inputArray[i]??MaskExpression.EMPTY_STRING){const symbolStarInPattern=MaskExpression.SYMBOL_STAR in this.patterns;if(this._checkSymbolMask(inputSymbol,maskExpression[cursor]??MaskExpression.EMPTY_STRING)&&maskExpression[cursor+1]===MaskExpression.SYMBOL_QUESTION)result+=inputSymbol,cursor+=2;else if(maskExpression[cursor+1]===MaskExpression.SYMBOL_STAR&&multi&&this._checkSymbolMask(inputSymbol,maskExpression[cursor+2]??MaskExpression.EMPTY_STRING))result+=inputSymbol,cursor+=3,multi=!1;else if(this._checkSymbolMask(inputSymbol,maskExpression[cursor]??MaskExpression.EMPTY_STRING)&&maskExpression[cursor+1]===MaskExpression.SYMBOL_STAR&&!symbolStarInPattern)result+=inputSymbol,multi=!0;else if(maskExpression[cursor+1]===MaskExpression.SYMBOL_QUESTION&&this._checkSymbolMask(inputSymbol,maskExpression[cursor+2]??MaskExpression.EMPTY_STRING))result+=inputSymbol,cursor+=3;else if(this._checkSymbolMask(inputSymbol,maskExpression[cursor]??MaskExpression.EMPTY_STRING)){if(maskExpression[cursor]===MaskExpression.HOURS&&(this.apm?Number(inputSymbol)>9:Number(inputSymbol)>2)){processedPosition=this.leadZeroDateTime?processedPosition:processedPosition+1,cursor+=1,this._shiftStep(cursor),i--,this.leadZeroDateTime&&(result+="0");continue}if(maskExpression[cursor]===MaskExpression.HOUR&&(this.apm?1===result.length&&Number(result)>1||"1"===result&&Number(inputSymbol)>2||1===processedValue.slice(cursor-1,cursor).length&&Number(processedValue.slice(cursor-1,cursor))>2||"1"===processedValue.slice(cursor-1,cursor)&&Number(inputSymbol)>2:"2"===result&&Number(inputSymbol)>3||("2"===result.slice(cursor-2,cursor)||"2"===result.slice(cursor-3,cursor)||"2"===result.slice(cursor-4,cursor)||"2"===result.slice(cursor-1,cursor))&&Number(inputSymbol)>3&&cursor>10)){processedPosition+=1,cursor+=1,i--;continue}if((maskExpression[cursor]===MaskExpression.MINUTE||maskExpression[cursor]===MaskExpression.SECOND)&&Number(inputSymbol)>5){processedPosition=this.leadZeroDateTime?processedPosition:processedPosition+1,cursor+=1,this._shiftStep(cursor),i--,this.leadZeroDateTime&&(result+="0");continue}const daysCount=31,inputValueCursor=processedValue[cursor],inputValueCursorPlusOne=processedValue[cursor+1],inputValueCursorPlusTwo=processedValue[cursor+2],inputValueCursorMinusOne=processedValue[cursor-1],inputValueCursorMinusTwo=processedValue[cursor-2],inputValueSliceMinusThreeMinusOne=processedValue.slice(cursor-3,cursor-1),inputValueSliceMinusOnePlusOne=processedValue.slice(cursor-1,cursor+1),inputValueSliceCursorPlusTwo=processedValue.slice(cursor,cursor+2),inputValueSliceMinusTwoCursor=processedValue.slice(cursor-2,cursor);if(maskExpression[cursor]===MaskExpression.DAY){const maskStartWithMonth=maskExpression.slice(0,2)===MaskExpression.MONTHS,startWithMonthInput=maskExpression.slice(0,2)===MaskExpression.MONTHS&&this.specialCharacters.includes(inputValueCursorMinusTwo);if(Number(inputSymbol)>3&&this.leadZeroDateTime||!maskStartWithMonth&&(Number(inputValueSliceCursorPlusTwo)>daysCount||Number(inputValueSliceMinusOnePlusOne)>daysCount||this.specialCharacters.includes(inputValueCursorPlusOne))||(startWithMonthInput?Number(inputValueSliceMinusOnePlusOne)>daysCount||!this.specialCharacters.includes(inputValueCursor)&&this.specialCharacters.includes(inputValueCursorPlusTwo)||this.specialCharacters.includes(inputValueCursor):Number(inputValueSliceCursorPlusTwo)>daysCount||this.specialCharacters.includes(inputValueCursorPlusOne)&&!backspaced)){processedPosition=this.leadZeroDateTime?processedPosition:processedPosition+1,cursor+=1,this._shiftStep(cursor),i--,this.leadZeroDateTime&&(result+="0");continue}}if(maskExpression[cursor]===MaskExpression.MONTH){const monthsCount=12,withoutDays=0===cursor&&(Number(inputSymbol)>2||Number(inputValueSliceCursorPlusTwo)>monthsCount||this.specialCharacters.includes(inputValueCursorPlusOne)&&!backspaced),specialChart=maskExpression.slice(cursor+2,cursor+3),day1monthInput=inputValueSliceMinusThreeMinusOne.includes(specialChart)&&maskExpression.includes("d0")&&(this.specialCharacters.includes(inputValueCursorMinusTwo)&&Number(inputValueSliceMinusOnePlusOne)>monthsCount&&!this.specialCharacters.includes(inputValueCursor)||this.specialCharacters.includes(inputValueCursor)),day2monthInput=Number(inputValueSliceMinusThreeMinusOne)<=daysCount&&!this.specialCharacters.includes(inputValueSliceMinusThreeMinusOne)&&this.specialCharacters.includes(inputValueCursorMinusOne)&&(Number(inputValueSliceCursorPlusTwo)>monthsCount||this.specialCharacters.includes(inputValueCursorPlusOne)),day2monthInputDot=Number(inputValueSliceCursorPlusTwo)>monthsCount&&5===cursor||this.specialCharacters.includes(inputValueCursorPlusOne)&&5===cursor,day1monthPaste=Number(inputValueSliceMinusThreeMinusOne)>daysCount&&!this.specialCharacters.includes(inputValueSliceMinusThreeMinusOne)&&!this.specialCharacters.includes(inputValueSliceMinusTwoCursor)&&Number(inputValueSliceMinusTwoCursor)>monthsCount&&maskExpression.includes("d0"),day2monthPaste=Number(inputValueSliceMinusThreeMinusOne)<=daysCount&&!this.specialCharacters.includes(inputValueSliceMinusThreeMinusOne)&&!this.specialCharacters.includes(inputValueCursorMinusOne)&&Number(inputValueSliceMinusOnePlusOne)>monthsCount;if(Number(inputSymbol)>1&&this.leadZeroDateTime||withoutDays||day1monthInput||day2monthPaste||day1monthPaste||day2monthInput||day2monthInputDot&&!this.leadZeroDateTime){processedPosition=this.leadZeroDateTime?processedPosition:processedPosition+1,cursor+=1,this._shiftStep(cursor),i--,this.leadZeroDateTime&&(result+="0");continue}}result+=inputSymbol,cursor++}else this.specialCharacters.includes(inputSymbol)&&maskExpression[cursor]===inputSymbol?(result+=inputSymbol,cursor++):-1!==this.specialCharacters.indexOf(maskExpression[cursor]??MaskExpression.EMPTY_STRING)?(result+=maskExpression[cursor],cursor++,this._shiftStep(cursor),i--):maskExpression[cursor]===MaskExpression.NUMBER_NINE&&this.showMaskTyped?this._shiftStep(cursor):this.patterns[maskExpression[cursor]??MaskExpression.EMPTY_STRING]&&this.patterns[maskExpression[cursor]??MaskExpression.EMPTY_STRING]?.optional?(!inputArray[cursor]||"099.099.099.099"===maskExpression||"000.000.000-00"===maskExpression||"00.000.000/0000-00"===maskExpression||maskExpression.match(/^9+\.0+$/)||this.patterns[maskExpression[cursor]??MaskExpression.EMPTY_STRING]?.optional||(result+=inputArray[cursor]),maskExpression.includes(MaskExpression.NUMBER_NINE+MaskExpression.SYMBOL_STAR)&&maskExpression.includes(MaskExpression.NUMBER_ZERO+MaskExpression.SYMBOL_STAR)&&cursor++,cursor++,i--):this.maskExpression[cursor+1]===MaskExpression.SYMBOL_STAR&&this._findSpecialChar(this.maskExpression[cursor+2]??MaskExpression.EMPTY_STRING)&&this._findSpecialChar(inputSymbol)===this.maskExpression[cursor+2]&&multi||this.maskExpression[cursor+1]===MaskExpression.SYMBOL_QUESTION&&this._findSpecialChar(this.maskExpression[cursor+2]??MaskExpression.EMPTY_STRING)&&this._findSpecialChar(inputSymbol)===this.maskExpression[cursor+2]&&multi?(cursor+=3,result+=inputSymbol):this.showMaskTyped&&this.specialCharacters.indexOf(inputSymbol)<0&&inputSymbol!==this.placeHolderCharacter&&1===this.placeHolderCharacter.length&&(stepBack=!0)}result[processedPosition-1]&&result.length+1===maskExpression.length&&-1!==this.specialCharacters.indexOf(maskExpression[maskExpression.length-1]??MaskExpression.EMPTY_STRING)&&(result+=maskExpression[maskExpression.length-1]);let newPosition=processedPosition+1;for(;this._shift.has(newPosition);)shift++,newPosition++;let actualShift=justPasted&&!maskExpression.startsWith(MaskExpression.SEPARATOR)?cursor:this._shift.has(processedPosition)?shift:0;stepBack&&actualShift--,cb(actualShift,backspaceShift),shift<0&&this._shift.clear();let onlySpecial=!1;backspaced&&(onlySpecial=inputArray.every((char=>this.specialCharacters.includes(char))));let res=`${this.prefix}${onlySpecial?MaskExpression.EMPTY_STRING:result}${this.showMaskTyped?"":this.suffix}`;0===result.length&&(res=this.instantPrefix?`${this.prefix}${result}`:`${result}`);const isSpecialCharacterMaskFirstSymbol=1===processedValue.length&&this.specialCharacters.includes(maskExpression[0])&&processedValue!==maskExpression[0];if(!this._checkSymbolMask(processedValue,maskExpression[1])&&isSpecialCharacterMaskFirstSymbol)return"";if(result.includes(MaskExpression.MINUS)&&this.prefix&&this.allowNegativeNumbers){if(backspaced&&result===MaskExpression.MINUS)return"";res=`${MaskExpression.MINUS}${this.prefix}${result.split(MaskExpression.MINUS).join(MaskExpression.EMPTY_STRING)}${this.suffix}`}return res}_findDropSpecialChar(inputSymbol){return Array.isArray(this.dropSpecialCharacters)?this.dropSpecialCharacters.find((val=>val===inputSymbol)):this._findSpecialChar(inputSymbol)}_findSpecialChar(inputSymbol){return this.specialCharacters.find((val=>val===inputSymbol))}_checkSymbolMask(inputSymbol,maskSymbol){return this.patterns=this.customPattern?this.customPattern:this.patterns,(this.patterns[maskSymbol]?.pattern&&this.patterns[maskSymbol]?.pattern.test(inputSymbol))??!1}_formatWithSeparators=(str,thousandSeparatorChar,decimalChars,precision)=>{let x=[],decimalChar="";if(Array.isArray(decimalChars)){const regExp=new RegExp(decimalChars.map((v=>"[\\^$.|?*+()".indexOf(v)>=0?`\\${v}`:v)).join("|"));x=str.split(regExp),decimalChar=str.match(regExp)?.[0]??MaskExpression.EMPTY_STRING}else x=str.split(decimalChars),decimalChar=decimalChars;const decimals=x.length>1?`${decimalChar}${x[1]}`:MaskExpression.EMPTY_STRING;let res=x[0]??MaskExpression.EMPTY_STRING;const separatorLimit=this.separatorLimit.replace(/\s/g,MaskExpression.EMPTY_STRING);separatorLimit&&+separatorLimit&&(res=res[0]===MaskExpression.MINUS?`-${res.slice(1,res.length).slice(0,separatorLimit.length)}`:res.slice(0,separatorLimit.length));const rgx=/(\d+)(\d{3})/;for(;thousandSeparatorChar&&rgx.test(res);)res=res.replace(rgx,"$1"+thousandSeparatorChar+"$2");return void 0===precision?res+decimals:0===precision?res:res+decimals.substring(0,precision+1)};percentage=str=>{const sanitizedStr=str.replace(",","."),value=Number(this.allowNegativeNumbers&&str.includes(MaskExpression.MINUS)?sanitizedStr.slice(1,str.length):sanitizedStr);return!isNaN(value)&&value>=0&&value<=100};getPrecision=maskExpression=>{const x=maskExpression.split(MaskExpression.DOT);return x.length>1?Number(x[x.length-1]):1/0};checkAndRemoveSuffix=inputValue=>{for(let i=this.suffix?.length-1;i>=0;i--){const substr=this.suffix.substring(i,this.suffix?.length);if(inputValue.includes(substr)&&i!==this.suffix?.length-1&&(i-1<0||!inputValue.includes(this.suffix.substring(i-1,this.suffix?.length))))return inputValue.replace(substr,MaskExpression.EMPTY_STRING)}return inputValue};checkInputPrecision=(inputValue,precision,decimalMarker)=>{let processedInputValue=inputValue,processedDecimalMarker=decimalMarker;if(precision<1/0){if(Array.isArray(processedDecimalMarker)){const marker=processedDecimalMarker.find((dm=>dm!==this.thousandSeparator));processedDecimalMarker=marker||processedDecimalMarker[0]}const precisionRegEx=new RegExp(this._charToRegExpExpression(processedDecimalMarker)+`\\d{${precision}}.*$`),precisionMatch=processedInputValue.match(precisionRegEx),precisionMatchLength=(precisionMatch&&precisionMatch[0]?.length)??0;if(precisionMatchLength-1>precision){const diff=precisionMatchLength-1-precision;processedInputValue=processedInputValue.substring(0,processedInputValue.length-diff)}0===precision&&this._compareOrIncludes(processedInputValue[processedInputValue.length-1],processedDecimalMarker,this.thousandSeparator)&&(processedInputValue=processedInputValue.substring(0,processedInputValue.length-1))}return processedInputValue};_stripToDecimal(str){return str.split(MaskExpression.EMPTY_STRING).filter(((i,idx)=>{const isDecimalMarker="string"==typeof this.decimalMarker?i===this.decimalMarker:this.decimalMarker.includes(i);return i.match("^-?\\d")||i===this.thousandSeparator||isDecimalMarker||i===MaskExpression.MINUS&&0===idx&&this.allowNegativeNumbers})).join(MaskExpression.EMPTY_STRING)}_charToRegExpExpression(char){if(char){return" "===char?"\\s":"[\\^$.|?*+()".indexOf(char)>=0?`\\${char}`:char}return char}_shiftStep(cursor){this._shift.add(cursor+this.prefix.length||0)}_compareOrIncludes(value,comparedValue,excludedValue){return Array.isArray(comparedValue)?comparedValue.filter((v=>v!==excludedValue)).includes(value):value===comparedValue}_validIP(valuesIP){return!(4===valuesIP.length&&!valuesIP.some(((value,index)=>valuesIP.length!==index+1?value===MaskExpression.EMPTY_STRING||Number(value)>255:value===MaskExpression.EMPTY_STRING||Number(value.substring(0,3))>255)))}_splitPercentZero(value){if(value===MaskExpression.MINUS&&this.allowNegativeNumbers)return value;const decimalIndex="string"==typeof this.decimalMarker?value.indexOf(this.decimalMarker):value.indexOf(MaskExpression.DOT),emptyOrMinus=this.allowNegativeNumbers&&value.includes(MaskExpression.MINUS)?"-":"";if(-1===decimalIndex){const parsedValue=parseInt(emptyOrMinus?value.slice(1,value.length):value,10);return isNaN(parsedValue)?MaskExpression.EMPTY_STRING:`${emptyOrMinus}${parsedValue}`}{const integerPart=parseInt(value.replace("-","").substring(0,decimalIndex),10),decimalPart=value.substring(decimalIndex+1),integerString=isNaN(integerPart)?"":integerPart.toString(),decimal="string"==typeof this.decimalMarker?this.decimalMarker:MaskExpression.DOT;return integerString===MaskExpression.EMPTY_STRING?MaskExpression.EMPTY_STRING:`${emptyOrMinus}${integerString}${decimal}${decimalPart}`}}_findFirstNonZeroAndDecimalIndex(inputString,decimalMarker){let decimalMarkerIndex=null,nonZeroIndex=null;for(let i=0;i<inputString.length;i++){const char=inputString[i];if(char===decimalMarker&&null===decimalMarkerIndex&&(decimalMarkerIndex=i),char&&char>="1"&&char<="9"&&null===nonZeroIndex&&(nonZeroIndex=i),null!==decimalMarkerIndex&&null!==nonZeroIndex)break}return{decimalMarkerIndex,nonZeroIndex}}static ɵfac=function NgxMaskApplierService_Factory(__ngFactoryType__){return new(__ngFactoryType__||NgxMaskApplierService)};static ɵprov=_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjectable"]({token:NgxMaskApplierService,factory:NgxMaskApplierService.ɵfac})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵsetClassMetadata"](NgxMaskApplierService,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Injectable}],null,null);class NgxMaskService extends NgxMaskApplierService{isNumberValue=!1;maskIsShown="";selStart=null;selEnd=null;maskChanged=!1;maskExpressionArray=[];triggerOnMaskChange=!1;previousValue="";currentValue="";writingValue=!1;_emitValue=!1;_start;_end;onChange=_=>{};_elementRef=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.ElementRef,{optional:!0});document=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(_angular_common__WEBPACK_IMPORTED_MODULE_1__.DOCUMENT);_config=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(NGX_MASK_CONFIG);_renderer=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.Renderer2,{optional:!0});applyMask(inputValue,maskExpression,position=0,justPasted=!1,backspaced=!1,cb=()=>{}){if(!maskExpression)return inputValue!==this.actualValue?this.actualValue:inputValue;if(this.maskIsShown=this.showMaskTyped?this.showMaskInInput():MaskExpression.EMPTY_STRING,this.maskExpression===MaskExpression.IP&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(inputValue||MaskExpression.HASH)),this.maskExpression===MaskExpression.CPF_CNPJ&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(inputValue||MaskExpression.HASH)),!inputValue&&this.showMaskTyped)return this.formControlResult(this.prefix),`${this.prefix}${this.maskIsShown}${this.suffix}`;const getSymbol=inputValue&&"number"==typeof this.selStart?inputValue[this.selStart]??MaskExpression.EMPTY_STRING:MaskExpression.EMPTY_STRING;let newInputValue="",newPosition=position;if((this.hiddenInput||inputValue&&inputValue.indexOf(MaskExpression.SYMBOL_STAR)>=0)&&!this.writingValue){let actualResult=inputValue&&1===inputValue.length?inputValue.split(MaskExpression.EMPTY_STRING):this.actualValue.split(MaskExpression.EMPTY_STRING);backspaced&&(actualResult=actualResult.slice(0,position).concat(actualResult.slice(position+1))),this.showMaskTyped&&(inputValue=this.removeMask(inputValue),actualResult=this.removeMask(actualResult.join("")).split(MaskExpression.EMPTY_STRING)),"object"==typeof this.selStart&&"object"==typeof this.selEnd?(this.selStart=Number(this.selStart),this.selEnd=Number(this.selEnd)):inputValue!==MaskExpression.EMPTY_STRING&&actualResult.length?"number"==typeof this.selStart&&"number"==typeof this.selEnd&&(inputValue.length>actualResult.length?actualResult.splice(this.selStart,0,getSymbol):inputValue.length<actualResult.length&&(actualResult.length-inputValue.length==1?backspaced?actualResult.splice(this.selStart-1,1):actualResult.splice(inputValue.length-1,1):actualResult.splice(this.selStart,this.selEnd-this.selStart))):actualResult=[],this.showMaskTyped&&!this.hiddenInput&&(newInputValue=this.removeMask(inputValue)),newInputValue=this.actualValue.length?actualResult.length<inputValue.length?this.shiftTypedSymbols(actualResult.join(MaskExpression.EMPTY_STRING)):actualResult.length===inputValue.length?actualResult.join(MaskExpression.EMPTY_STRING):inputValue:inputValue}if(!justPasted||!this.hiddenInput&&this.hiddenInput||(newInputValue=inputValue),backspaced&&-1!==this.specialCharacters.indexOf(this.maskExpression[newPosition]??MaskExpression.EMPTY_STRING)&&this.showMaskTyped&&!this.prefix&&(newInputValue=this.currentValue),this.deletedSpecialCharacter&&newPosition&&(this.specialCharacters.includes(this.actualValue.slice(newPosition,newPosition+1))?newPosition+=1:maskExpression.slice(newPosition-1,newPosition+1)!==MaskExpression.MONTHS&&(newPosition-=2),this.deletedSpecialCharacter=!1),this.showMaskTyped&&1===this.placeHolderCharacter.length&&!this.leadZeroDateTime&&(newInputValue=this.removeMask(newInputValue)),newInputValue=this.maskChanged?inputValue:Boolean(newInputValue)&&newInputValue.length?newInputValue:inputValue,this.showMaskTyped&&this.keepCharacterPositions&&this.actualValue&&!justPasted&&!this.writingValue){const value=this.dropSpecialCharacters?this.removeMask(this.actualValue):this.actualValue;return this.formControlResult(value),this.actualValue?this.actualValue:`${this.prefix}${this.maskIsShown}${this.suffix}`}const result=super.applyMask(newInputValue,maskExpression,newPosition,justPasted,backspaced,cb);if(this.actualValue=this.getActualValue(result),this.thousandSeparator===MaskExpression.DOT&&this.decimalMarker===MaskExpression.DOT&&(this.decimalMarker=MaskExpression.COMMA),this.maskExpression.startsWith(MaskExpression.SEPARATOR)&&!0===this.dropSpecialCharacters&&(this.specialCharacters=this.specialCharacters.filter((item=>!this._compareOrIncludes(item,this.decimalMarker,this.thousandSeparator)))),(result||""===result)&&(this.previousValue=this.currentValue,this.currentValue=result,this._emitValue=this.previousValue!==this.currentValue||this.maskChanged||this.writingValue||this.previousValue===this.currentValue&&justPasted),this._emitValue&&(this.writingValue&&this.triggerOnMaskChange?requestAnimationFrame((()=>this.formControlResult(result))):this.formControlResult(result)),!this.showMaskTyped||this.showMaskTyped&&this.hiddenInput)return this.hiddenInput?`${this.hideInput(result,this.maskExpression)}${this.maskIsShown.slice(result.length)}`:result;const resLen=result.length,prefNmask=`${this.prefix}${this.maskIsShown}${this.suffix}`;if(this.maskExpression.includes(MaskExpression.HOURS)){const countSkipedSymbol=this._numberSkipedSymbols(result);return`${result}${prefNmask.slice(resLen+countSkipedSymbol)}`}return this.maskExpression===MaskExpression.IP||this.maskExpression===MaskExpression.CPF_CNPJ?`${result}${prefNmask}`:`${result}${prefNmask.slice(resLen)}`}_numberSkipedSymbols(value){const regex=/(^|\D)(\d\D)/g;let match=regex.exec(value),countSkipedSymbol=0;for(;null!=match;)countSkipedSymbol+=1,match=regex.exec(value);return countSkipedSymbol}applyValueChanges(position,justPasted,backspaced,cb=()=>{}){const formElement=this._elementRef?.nativeElement;formElement&&(formElement.value=this.applyMask(formElement.value,this.maskExpression,position,justPasted,backspaced,cb),formElement!==this._getActiveElement()&&this.clearIfNotMatchFn())}hideInput(inputValue,maskExpression){return inputValue.split(MaskExpression.EMPTY_STRING).map(((curr,index)=>this.patterns&&this.patterns[maskExpression[index]??MaskExpression.EMPTY_STRING]&&this.patterns[maskExpression[index]??MaskExpression.EMPTY_STRING]?.symbol?this.patterns[maskExpression[index]??MaskExpression.EMPTY_STRING]?.symbol:curr)).join(MaskExpression.EMPTY_STRING)}getActualValue(res){const compare=res.split(MaskExpression.EMPTY_STRING).filter(((symbol,i)=>{const maskChar=this.maskExpression[i]??MaskExpression.EMPTY_STRING;return this._checkSymbolMask(symbol,maskChar)||this.specialCharacters.includes(maskChar)&&symbol===maskChar}));return compare.join(MaskExpression.EMPTY_STRING)===res?compare.join(MaskExpression.EMPTY_STRING):res}shiftTypedSymbols(inputValue){let symbolToReplace="";return(inputValue&&inputValue.split(MaskExpression.EMPTY_STRING).map(((currSymbol,index)=>{if(this.specialCharacters.includes(inputValue[index+1]??MaskExpression.EMPTY_STRING)&&inputValue[index+1]!==this.maskExpression[index+1])return symbolToReplace=currSymbol,inputValue[index+1];if(symbolToReplace.length){const replaceSymbol=symbolToReplace;return symbolToReplace=MaskExpression.EMPTY_STRING,replaceSymbol}return currSymbol}))||[]).join(MaskExpression.EMPTY_STRING)}numberToString(value){return!value&&0!==value||this.maskExpression.startsWith(MaskExpression.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters)||this.maskExpression.startsWith(MaskExpression.SEPARATOR)&&this.separatorLimit.length>14&&String(value).length>14?String(value):Number(value).toLocaleString("fullwide",{useGrouping:!1,maximumFractionDigits:20}).replace(`/${MaskExpression.MINUS}/`,MaskExpression.MINUS)}showMaskInInput(inputVal){if(this.showMaskTyped&&this.shownMaskExpression){if(this.maskExpression.length!==this.shownMaskExpression.length)throw new Error("Mask expression must match mask placeholder length");return this.shownMaskExpression}if(this.showMaskTyped){if(inputVal){if(this.maskExpression===MaskExpression.IP)return this._checkForIp(inputVal);if(this.maskExpression===MaskExpression.CPF_CNPJ)return this._checkForCpfCnpj(inputVal)}return this.placeHolderCharacter.length===this.maskExpression.length?this.placeHolderCharacter:this.maskExpression.replace(/\w/g,this.placeHolderCharacter)}return""}clearIfNotMatchFn(){const formElement=this._elementRef?.nativeElement;formElement&&this.clearIfNotMatch&&this.prefix.length+this.maskExpression.length+this.suffix.length!==formElement.value.replace(this.placeHolderCharacter,MaskExpression.EMPTY_STRING).length&&(this.formElementProperty=["value",MaskExpression.EMPTY_STRING],this.applyMask("",this.maskExpression))}set formElementProperty([name,value]){this._renderer&&this._elementRef&&Promise.resolve().then((()=>this._renderer?.setProperty(this._elementRef?.nativeElement,name,value)))}checkDropSpecialCharAmount(mask){return mask.split(MaskExpression.EMPTY_STRING).filter((item=>this._findDropSpecialChar(item))).length}removeMask(inputValue){return this._removeMask(this._removeSuffix(this._removePrefix(inputValue)),this.specialCharacters.concat("_").concat(this.placeHolderCharacter))}_checkForIp(inputVal){if(inputVal===MaskExpression.HASH)return`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;const arr=[];for(let i=0;i<inputVal.length;i++){const value=inputVal[i]??MaskExpression.EMPTY_STRING;value&&(value.match("\\d")&&arr.push(value))}return arr.length<=3?`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`:arr.length>3&&arr.length<=6?`${this.placeHolderCharacter}.${this.placeHolderCharacter}`:arr.length>6&&arr.length<=9?this.placeHolderCharacter:(arr.length>9&&arr.length,"")}_checkForCpfCnpj(inputVal){const cpf=`${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`,cnpj=`${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}/${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`;if(inputVal===MaskExpression.HASH)return cpf;const arr=[];for(let i=0;i<inputVal.length;i++){const value=inputVal[i]??MaskExpression.EMPTY_STRING;value&&(value.match("\\d")&&arr.push(value))}return arr.length<=3?cpf.slice(arr.length,cpf.length):arr.length>3&&arr.length<=6?cpf.slice(arr.length+1,cpf.length):arr.length>6&&arr.length<=9?cpf.slice(arr.length+2,cpf.length):arr.length>9&&arr.length<11?cpf.slice(arr.length+3,cpf.length):11===arr.length?"":12===arr.length?17===inputVal.length?cnpj.slice(16,cnpj.length):cnpj.slice(15,cnpj.length):arr.length>12&&arr.length<=14?cnpj.slice(arr.length+4,cnpj.length):""}_getActiveElement(document=this.document){const shadowRootEl=document?.activeElement?.shadowRoot;return shadowRootEl?.activeElement?this._getActiveElement(shadowRootEl):document.activeElement}formControlResult(inputValue){if(!this.writingValue||inputValue)return this.writingValue||!this.triggerOnMaskChange&&this.maskChanged?(this.triggerOnMaskChange&&this.maskChanged&&this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(inputValue)))))),this.writingValue=!1,void(this.maskChanged=!1)):void(Array.isArray(this.dropSpecialCharacters)?this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeMask(this._removeSuffix(this._removePrefix(inputValue)),this.dropSpecialCharacters))))):this.dropSpecialCharacters||!this.dropSpecialCharacters&&this.prefix===inputValue?this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(inputValue)))))):this.onChange(this.outputTransformFn(this._toNumber(inputValue))));this.onChange(this.outputTransformFn(null))}_toNumber(value){if(!this.isNumberValue||value===MaskExpression.EMPTY_STRING)return value;if(this.maskExpression.startsWith(MaskExpression.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters))return value;if(String(value).length>14&&this.maskExpression.startsWith(MaskExpression.SEPARATOR))return String(value);const num=Number(value);if(this.maskExpression.startsWith(MaskExpression.SEPARATOR)&&Number.isNaN(num)){const val=String(value).replace(",",".");return Number(val)}return Number.isNaN(num)?value:num}_removeMask(value,specialCharactersForRemove){return this.maskExpression.startsWith(MaskExpression.PERCENT)&&value.includes(MaskExpression.DOT)?value:value?value.replace(this._regExpForRemove(specialCharactersForRemove),MaskExpression.EMPTY_STRING):value}_removePrefix(value){return this.prefix&&value?value.replace(this.prefix,MaskExpression.EMPTY_STRING):value}_removeSuffix(value){return this.suffix&&value?value.replace(this.suffix,MaskExpression.EMPTY_STRING):value}_retrieveSeparatorValue(result){let specialCharacters=Array.isArray(this.dropSpecialCharacters)?this.specialCharacters.filter((v=>this.dropSpecialCharacters.includes(v))):this.specialCharacters;return!this.deletedSpecialCharacter&&this._checkPatternForSpace()&&result.includes(MaskExpression.WHITE_SPACE)&&this.maskExpression.includes(MaskExpression.SYMBOL_STAR)&&(specialCharacters=specialCharacters.filter((char=>char!==MaskExpression.WHITE_SPACE))),this._removeMask(result,specialCharacters)}_regExpForRemove(specialCharactersForRemove){return new RegExp(specialCharactersForRemove.map((item=>`\\${item}`)).join("|"),"gi")}_replaceDecimalMarkerToDot(value){const markers=Array.isArray(this.decimalMarker)?this.decimalMarker:[this.decimalMarker];return value.replace(this._regExpForRemove(markers),MaskExpression.DOT)}_checkSymbols(result){let processedResult=result;if(processedResult===MaskExpression.EMPTY_STRING)return processedResult;this.maskExpression.startsWith(MaskExpression.PERCENT)&&this.decimalMarker===MaskExpression.COMMA&&(processedResult=processedResult.replace(MaskExpression.COMMA,MaskExpression.DOT));const separatorPrecision=this._retrieveSeparatorPrecision(this.maskExpression),separatorValue=0===this.specialCharacters.length?this._retrieveSeparatorValue(processedResult):this._replaceDecimalMarkerToDot(this._retrieveSeparatorValue(processedResult));return this.isNumberValue&&separatorPrecision?processedResult===this.decimalMarker?null:separatorValue.length>14?String(separatorValue):this._checkPrecision(this.maskExpression,separatorValue):separatorValue}_checkPatternForSpace(){for(const key in this.patterns)if(this.patterns[key]&&this.patterns[key]?.hasOwnProperty("pattern")){const patternString=this.patterns[key]?.pattern.toString(),pattern=this.patterns[key]?.pattern;if(patternString?.includes(MaskExpression.WHITE_SPACE)&&pattern?.test(this.maskExpression))return!0}return!1}_retrieveSeparatorPrecision(maskExpretion){const matcher=maskExpretion.match(new RegExp("^separator\\.([^d]*)"));return matcher?Number(matcher[1]):null}_checkPrecision(separatorExpression,separatorValue){const separatorPrecision=this.getPrecision(separatorExpression);let value=separatorValue;return separatorExpression.indexOf("2")>0||this.leadZero&&Number(separatorPrecision)>0?(this.decimalMarker===MaskExpression.COMMA&&this.leadZero&&(value=value.replace(",",".")),this.leadZero?Number(value).toFixed(Number(separatorPrecision)):Number(value).toFixed(2)):this.numberToString(value)}_repeatPatternSymbols(maskExp){return maskExp.match(/{[0-9]+}/)&&maskExp.split(MaskExpression.EMPTY_STRING).reduce(((accum,currVal,index)=>{if(this._start=currVal===MaskExpression.CURLY_BRACKETS_LEFT?index:this._start,currVal!==MaskExpression.CURLY_BRACKETS_RIGHT)return this._findSpecialChar(currVal)?accum+currVal:accum;this._end=index;const repeatNumber=Number(maskExp.slice(this._start+1,this._end)),replaceWith=new Array(repeatNumber+1).join(maskExp[this._start-1]);if(maskExp.slice(0,this._start).length>1&&maskExp.includes(MaskExpression.LETTER_S)){const symbols=maskExp.slice(0,this._start-1);return symbols.includes(MaskExpression.CURLY_BRACKETS_LEFT)?accum+replaceWith:symbols+accum+replaceWith}return accum+replaceWith}),"")||maskExp}currentLocaleDecimalMarker(){return 1.1.toLocaleString().substring(1,2)}static ɵfac=(()=>{let ɵNgxMaskService_BaseFactory;return function NgxMaskService_Factory(__ngFactoryType__){return(ɵNgxMaskService_BaseFactory||(ɵNgxMaskService_BaseFactory=_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵgetInheritedFactory"](NgxMaskService)))(__ngFactoryType__||NgxMaskService)}})();static ɵprov=_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjectable"]({token:NgxMaskService,factory:NgxMaskService.ɵfac})}function _configFactory(){const initConfig=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(INITIAL_CONFIG),configValue=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(NEW_CONFIG);return configValue instanceof Function?{...initConfig,...configValue()}:{...initConfig,...configValue}}function provideNgxMask(configValue){return[{provide:NEW_CONFIG,useValue:configValue},{provide:INITIAL_CONFIG,useValue:initialConfig},{provide:NGX_MASK_CONFIG,useFactory:_configFactory},NgxMaskService]}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵsetClassMetadata"](NgxMaskService,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Injectable}],null,null);class NgxMaskDirective{mask=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)("");specialCharacters=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)([]);patterns=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)({});prefix=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)("");suffix=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)("");thousandSeparator=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(" ");decimalMarker=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(".");dropSpecialCharacters=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);hiddenInput=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);showMaskTyped=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);placeHolderCharacter=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);shownMaskExpression=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);clearIfNotMatch=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);validation=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);separatorLimit=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)("");allowNegativeNumbers=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);leadZeroDateTime=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);leadZero=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);triggerOnMaskChange=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);apm=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);inputTransformFn=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);outputTransformFn=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);keepCharacterPositions=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);instantPrefix=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.input)(null);maskFilled=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.output)();_maskValue=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.signal)("");_inputValue=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.signal)("");_position=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.signal)(null);_code=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.signal)("");_maskExpressionArray=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.signal)([]);_justPasted=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.signal)(!1);_isFocused=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.signal)(!1);_isComposing=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.signal)(!1);_maskService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(NgxMaskService,{self:!0});document=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(_angular_common__WEBPACK_IMPORTED_MODULE_1__.DOCUMENT);_config=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(NGX_MASK_CONFIG);onChange=_=>{};onTouch=()=>{};ngOnChanges(changes){const{mask,specialCharacters,patterns,prefix,suffix,thousandSeparator,decimalMarker,dropSpecialCharacters,hiddenInput,showMaskTyped,placeHolderCharacter,shownMaskExpression,clearIfNotMatch,validation,separatorLimit,allowNegativeNumbers,leadZeroDateTime,leadZero,triggerOnMaskChange,apm,inputTransformFn,outputTransformFn,keepCharacterPositions,instantPrefix}=changes;if(mask&&(mask.currentValue===mask.previousValue||mask.firstChange||(this._maskService.maskChanged=!0),mask.currentValue&&mask.currentValue.split(MaskExpression.OR).length>1?(this._maskExpressionArray.set(mask.currentValue.split(MaskExpression.OR).sort(((a,b)=>a.length-b.length))),this._setMask()):(this._maskExpressionArray.set([]),this._maskValue.set(mask.currentValue||MaskExpression.EMPTY_STRING),this._maskService.maskExpression=this._maskValue())),specialCharacters){if(!specialCharacters.currentValue||!Array.isArray(specialCharacters.currentValue))return;this._maskService.specialCharacters=specialCharacters.currentValue||[]}if(allowNegativeNumbers&&(this._maskService.allowNegativeNumbers=allowNegativeNumbers.currentValue,this._maskService.allowNegativeNumbers&&(this._maskService.specialCharacters=this._maskService.specialCharacters.filter((c=>c!==MaskExpression.MINUS)))),patterns&&patterns.currentValue&&(this._maskService.patterns=patterns.currentValue),apm&&apm.currentValue&&(this._maskService.apm=apm.currentValue),instantPrefix&&(this._maskService.instantPrefix=instantPrefix.currentValue),prefix&&(this._maskService.prefix=prefix.currentValue),suffix&&(this._maskService.suffix=suffix.currentValue),thousandSeparator&&(this._maskService.thousandSeparator=thousandSeparator.currentValue,thousandSeparator.previousValue&&thousandSeparator.currentValue)){const previousDecimalMarker=this._maskService.decimalMarker;thousandSeparator.currentValue===this._maskService.decimalMarker&&(this._maskService.decimalMarker=thousandSeparator.currentValue===MaskExpression.COMMA?MaskExpression.DOT:MaskExpression.COMMA),!0===this._maskService.dropSpecialCharacters&&(this._maskService.specialCharacters=this._config.specialCharacters),"string"==typeof previousDecimalMarker&&"string"==typeof this._maskService.decimalMarker&&(this._inputValue.set(this._inputValue().split(thousandSeparator.previousValue).join("").replace(previousDecimalMarker,this._maskService.decimalMarker)),this._maskService.actualValue=this._inputValue()),this._maskService.writingValue=!0}decimalMarker&&(this._maskService.decimalMarker=decimalMarker.currentValue),dropSpecialCharacters&&(this._maskService.dropSpecialCharacters=dropSpecialCharacters.currentValue),hiddenInput&&(this._maskService.hiddenInput=hiddenInput.currentValue,!0===hiddenInput.previousValue&&!1===hiddenInput.currentValue&&this._inputValue.set(this._maskService.actualValue)),showMaskTyped&&(this._maskService.showMaskTyped=showMaskTyped.currentValue,!1===showMaskTyped.previousValue&&!0===showMaskTyped.currentValue&&this._isFocused()&&requestAnimationFrame((()=>{this._maskService._elementRef?.nativeElement.click()}))),placeHolderCharacter&&(this._maskService.placeHolderCharacter=placeHolderCharacter.currentValue),shownMaskExpression&&(this._maskService.shownMaskExpression=shownMaskExpression.currentValue),clearIfNotMatch&&(this._maskService.clearIfNotMatch=clearIfNotMatch.currentValue),validation&&(this._maskService.validation=validation.currentValue),separatorLimit&&(this._maskService.separatorLimit=separatorLimit.currentValue),leadZeroDateTime&&(this._maskService.leadZeroDateTime=leadZeroDateTime.currentValue),leadZero&&(this._maskService.leadZero=leadZero.currentValue),triggerOnMaskChange&&(this._maskService.triggerOnMaskChange=triggerOnMaskChange.currentValue),inputTransformFn&&(this._maskService.inputTransformFn=inputTransformFn.currentValue),outputTransformFn&&(this._maskService.outputTransformFn=outputTransformFn.currentValue),keepCharacterPositions&&(this._maskService.keepCharacterPositions=keepCharacterPositions.currentValue),this._applyMask()}validate({value}){const processedValue="number"==typeof value?String(value):value,maskValue=this._maskValue();if(!this._maskService.validation||!maskValue)return null;if(this._maskService.ipError)return this._createValidationError(processedValue);if(this._maskService.cpfCnpjError)return this._createValidationError(processedValue);if(maskValue.startsWith(MaskExpression.SEPARATOR))return null;if(withoutValidation.includes(maskValue))return null;if(this._maskService.clearIfNotMatch)return null;if(timeMasks.includes(maskValue))return this._validateTime(processedValue);if(maskValue===MaskExpression.EMAIL_MASK){return!/^[^@]+@[^@]+\.[^@]+$/.test(processedValue)&&processedValue?this._createValidationError(processedValue):null}if(processedValue&&processedValue.length>=1){let counterOfOpt=0;if(maskValue.includes(MaskExpression.CURLY_BRACKETS_LEFT)&&maskValue.includes(MaskExpression.CURLY_BRACKETS_RIGHT)){return maskValue.slice(maskValue.indexOf(MaskExpression.CURLY_BRACKETS_LEFT)+1,maskValue.indexOf(MaskExpression.CURLY_BRACKETS_RIGHT))===String(processedValue.length)?null:this._createValidationError(processedValue)}if(maskValue.startsWith(MaskExpression.PERCENT))return null;for(const key in this._maskService.patterns)if(this._maskService.patterns[key]?.optional){if(maskValue.indexOf(key)!==maskValue.lastIndexOf(key)){counterOfOpt+=maskValue.split(MaskExpression.EMPTY_STRING).filter((i=>i===key)).join(MaskExpression.EMPTY_STRING).length}else-1!==maskValue.indexOf(key)&&counterOfOpt++;if(-1!==maskValue.indexOf(key)&&processedValue.length>=maskValue.indexOf(key))return null;if(counterOfOpt===maskValue.length)return null}if(maskValue.indexOf(MaskExpression.SYMBOL_STAR)>1&&processedValue.length<maskValue.indexOf(MaskExpression.SYMBOL_STAR)||maskValue.indexOf(MaskExpression.SYMBOL_QUESTION)>1&&processedValue.length<maskValue.indexOf(MaskExpression.SYMBOL_QUESTION))return this._createValidationError(processedValue);if(-1===maskValue.indexOf(MaskExpression.SYMBOL_STAR)||-1===maskValue.indexOf(MaskExpression.SYMBOL_QUESTION)){const array=maskValue.split("*"),length=this._maskService.dropSpecialCharacters?maskValue.length-this._maskService.checkDropSpecialCharAmount(maskValue)-counterOfOpt:this.prefix()?maskValue.length+this.prefix().length-counterOfOpt:maskValue.length-counterOfOpt;if(1===array.length&&processedValue.length<length)return this._createValidationError(processedValue);if(array.length>1){const lastIndexArray=array[array.length-1];if(lastIndexArray&&this._maskService.specialCharacters.includes(lastIndexArray[0])&&String(processedValue).includes(lastIndexArray[0]??"")&&!this.dropSpecialCharacters()){const special=value.split(lastIndexArray[0]);return special[special.length-1].length===lastIndexArray.length-1?null:this._createValidationError(processedValue)}return(lastIndexArray&&!this._maskService.specialCharacters.includes(lastIndexArray[0])||!lastIndexArray||this._maskService.dropSpecialCharacters)&&processedValue.length>=length-1?null:this._createValidationError(processedValue)}}if(1===maskValue.indexOf(MaskExpression.SYMBOL_STAR)||1===maskValue.indexOf(MaskExpression.SYMBOL_QUESTION))return null}return value?(this.maskFilled.emit(),null):null}onPaste(){this._justPasted.set(!0)}onFocus(){this._isFocused.set(!0)}onModelChange(value){value!==MaskExpression.EMPTY_STRING&&null!=value||!this._maskService.actualValue||(this._maskService.actualValue=this._maskService.getActualValue(MaskExpression.EMPTY_STRING))}onInput(e){if(this._isComposing())return;const el=e.target,transformedValue=this._maskService.inputTransformFn(el.value);if("number"!==el.type)if("string"==typeof transformedValue||"number"==typeof transformedValue){if(el.value=transformedValue.toString(),this._inputValue.set(el.value),this._setMask(),!this._maskValue())return void this.onChange(el.value);let position=1===el.selectionStart?el.selectionStart+this._maskService.prefix.length:el.selectionStart;if(this.showMaskTyped()&&this.keepCharacterPositions()&&1===this._maskService.placeHolderCharacter.length){const suffix=this.suffix(),prefix=this.prefix(),inputSymbol=el.value.slice(position-1,position),prefixLength=prefix.length,checkSymbols=this._maskService._checkSymbolMask(inputSymbol,this._maskService.maskExpression[position-1-prefixLength]??MaskExpression.EMPTY_STRING),checkSpecialCharacter=this._maskService._checkSymbolMask(inputSymbol,this._maskService.maskExpression[position+1-prefixLength]??MaskExpression.EMPTY_STRING),selectRangeBackspace=this._maskService.selStart===this._maskService.selEnd,selStart=Number(this._maskService.selStart)-prefixLength,selEnd=Number(this._maskService.selEnd)-prefixLength,backspaceOrDelete=this._code()===MaskExpression.BACKSPACE||this._code()===MaskExpression.DELETE;if(backspaceOrDelete){if(selectRangeBackspace){if(!this._maskService.specialCharacters.includes(this._maskService.maskExpression.slice(position-prefixLength,position+1-prefixLength))&&selectRangeBackspace)if(1===selStart&&prefix)this._maskService.actualValue=`${prefix}${this._maskService.placeHolderCharacter}${el.value.split(prefix).join("").split(suffix).join("")}${suffix}`,position-=1;else{const part1=el.value.substring(0,position),part2=el.value.substring(position);this._maskService.actualValue=`${part1}${this._maskService.placeHolderCharacter}${part2}`}}else this._maskService.selStart===prefixLength?this._maskService.actualValue=`${prefix}${this._maskService.maskIsShown.slice(0,selEnd)}${this._inputValue().split(prefix).join("")}`:this._maskService.selStart===this._maskService.maskIsShown.length+prefixLength?this._maskService.actualValue=`${this._inputValue()}${this._maskService.maskIsShown.slice(selStart,selEnd)}`:this._maskService.actualValue=`${prefix}${this._inputValue().split(prefix).join("").slice(0,selStart)}${this._maskService.maskIsShown.slice(selStart,selEnd)}${this._maskService.actualValue.slice(selEnd+prefixLength,this._maskService.maskIsShown.length+prefixLength)}${suffix}`;position=this._code()===MaskExpression.DELETE?position+1:position}backspaceOrDelete||(checkSymbols||checkSpecialCharacter||!selectRangeBackspace?this._maskService.specialCharacters.includes(el.value.slice(position,position+1))&&checkSpecialCharacter&&!this._maskService.specialCharacters.includes(el.value.slice(position+1,position+2))?(this._maskService.actualValue=`${el.value.slice(0,position-1)}${el.value.slice(position,position+1)}${inputSymbol}${el.value.slice(position+2)}`,position+=1):checkSymbols?1===el.value.length&&1===position?this._maskService.actualValue=`${prefix}${inputSymbol}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${suffix}`:this._maskService.actualValue=`${el.value.slice(0,position-1)}${inputSymbol}${el.value.slice(position+1).split(suffix).join("")}${suffix}`:prefix&&1===el.value.length&&position-prefixLength==1&&this._maskService._checkSymbolMask(el.value,this._maskService.maskExpression[position-1-prefixLength]??MaskExpression.EMPTY_STRING)&&(this._maskService.actualValue=`${prefix}${el.value}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${suffix}`):position=Number(el.selectionStart)-1)}let caretShift=0,backspaceShift=!1;if(this._code()===MaskExpression.DELETE&&MaskExpression.SEPARATOR&&(this._maskService.deletedSpecialCharacter=!0),this._inputValue().length>=this._maskService.maskExpression.length-1&&this._code()!==MaskExpression.BACKSPACE&&this._maskService.maskExpression===MaskExpression.DAYS_MONTHS_YEARS&&position<10){const inputSymbol=this._inputValue().slice(position-1,position);el.value=this._inputValue().slice(0,position-1)+inputSymbol+this._inputValue().slice(position+1)}if(this._maskService.maskExpression===MaskExpression.DAYS_MONTHS_YEARS&&this.leadZeroDateTime()&&(position<3&&Number(el.value)>31&&Number(el.value)<40||5===position&&Number(el.value.slice(3,5))>12)&&(position+=2),this._maskService.maskExpression===MaskExpression.HOURS_MINUTES_SECONDS&&this.apm()&&(this._justPasted()&&el.value.slice(0,2)===MaskExpression.DOUBLE_ZERO&&(el.value=el.value.slice(1,2)+el.value.slice(2,el.value.length)),el.value=el.value===MaskExpression.DOUBLE_ZERO?MaskExpression.NUMBER_ZERO:el.value),this._maskService.applyValueChanges(position,this._justPasted(),this._code()===MaskExpression.BACKSPACE||this._code()===MaskExpression.DELETE,((shift,_backspaceShift)=>{this._justPasted.set(!1),caretShift=shift,backspaceShift=_backspaceShift})),this._getActiveElement()!==el)return;if(this._maskService.plusOnePosition&&(position+=1,this._maskService.plusOnePosition=!1),this._maskExpressionArray().length)if(this._code()===MaskExpression.BACKSPACE){const specialChartMinusOne=this.specialCharacters().includes(this._maskService.actualValue.slice(position-1,position)),allowFewMaskChangeMask=this._maskService.removeMask(this._inputValue())?.length===this._maskService.removeMask(this._maskService.maskExpression)?.length,specialChartPlusOne=this.specialCharacters().includes(this._maskService.actualValue.slice(position,position+1));position=allowFewMaskChangeMask&&!specialChartPlusOne?el.selectionStart+1:specialChartMinusOne?position-1:position}else position=1===el.selectionStart?el.selectionStart+this._maskService.prefix.length:el.selectionStart;this._position.set(1===this._position()&&1===this._inputValue().length?null:this._position());let positionToApply=this._position()?this._inputValue().length+position+caretShift:position+(this._code()!==MaskExpression.BACKSPACE||backspaceShift?caretShift:0);positionToApply>this._getActualInputLength()&&(positionToApply=el.value===this._maskService.decimalMarker&&1===el.value.length?this._getActualInputLength()+1:this._getActualInputLength()),positionToApply<0&&(positionToApply=0),el.setSelectionRange(positionToApply,positionToApply),this._position.set(null)}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof transformedValue);else{if(!this._maskValue())return void this.onChange(el.value);this._maskService.applyValueChanges(el.value.length,this._justPasted(),this._code()===MaskExpression.BACKSPACE||this._code()===MaskExpression.DELETE)}}onCompositionStart(){this._isComposing.set(!0)}onCompositionEnd(e){this._isComposing.set(!1),this._justPasted.set(!0),this.onInput(e)}onBlur(e){if(this._maskValue()){const el=e.target;if(this._maskService.leadZero&&el.value.length>0&&"string"==typeof this._maskService.decimalMarker){const maskExpression=this._maskService.maskExpression,decimalMarker=this._maskService.decimalMarker,suffix=this._maskService.suffix,precision=Number(this._maskService.maskExpression.slice(maskExpression.length-1,maskExpression.length));if(precision>0){el.value=suffix?el.value.split(suffix).join(""):el.value;const decimalPart=el.value.split(decimalMarker)[1];el.value=el.value.includes(decimalMarker)?el.value+MaskExpression.NUMBER_ZERO.repeat(precision-decimalPart.length)+suffix:el.value+decimalMarker+MaskExpression.NUMBER_ZERO.repeat(precision)+suffix,this._maskService.actualValue=el.value}}this._maskService.clearIfNotMatchFn()}this._isFocused.set(!1),this.onTouch()}onClick(e){if(!this._maskValue())return;const el=e.target;null!==el&&null!==el.selectionStart&&el.selectionStart===el.selectionEnd&&el.selectionStart>this._maskService.prefix.length&&38!==e.keyCode&&this._maskService.showMaskTyped&&!this.keepCharacterPositions()&&(this._maskService.maskIsShown=this._maskService.showMaskInInput(),el.setSelectionRange&&this._maskService.prefix+this._maskService.maskIsShown===el.value?(el.focus(),el.setSelectionRange(0,0)):el.selectionStart>this._maskService.actualValue.length&&el.setSelectionRange(this._maskService.actualValue.length,this._maskService.actualValue.length));const nextValue=el&&(el.value===this._maskService.prefix?this._maskService.prefix+this._maskService.maskIsShown:el.value);if(el&&el.value!==nextValue&&(el.value=nextValue),el&&"number"!==el.type&&(el.selectionStart||el.selectionEnd)<=this._maskService.prefix.length){const specialCharactersAtTheStart=this._maskService.maskExpression.match(new RegExp(`^[${this._maskService.specialCharacters.map((c=>`\\${c}`)).join("")}]+`))?.[0].length||0;el.selectionStart=this._maskService.prefix.length+specialCharactersAtTheStart}else el&&el.selectionEnd>this._getActualInputLength()&&(el.selectionEnd=this._getActualInputLength())}onKeyDown(e){if(!this._maskValue())return;if(this._isComposing())return void("Enter"===e.key&&this.onCompositionEnd(e));this._code.set(e.code?e.code:e.key);const el=e.target;if(this._inputValue.set(el.value),this._setMask(),"number"!==el.type){if(e.key===MaskExpression.ARROW_UP&&e.preventDefault(),e.key===MaskExpression.ARROW_LEFT||e.key===MaskExpression.BACKSPACE||e.key===MaskExpression.DELETE){if(e.key===MaskExpression.BACKSPACE&&0===el.value.length&&(el.selectionStart=el.selectionEnd),e.key===MaskExpression.BACKSPACE&&0!==el.selectionStart){const prefixLength=this.prefix().length,specialCharacters=this.specialCharacters().length?this.specialCharacters():this._config.specialCharacters;if(prefixLength>1&&el.selectionStart<=prefixLength)el.setSelectionRange(prefixLength,el.selectionEnd);else if(this._inputValue().length!==el.selectionStart&&1!==el.selectionStart)for(;specialCharacters.includes((this._inputValue()[el.selectionStart-1]??MaskExpression.EMPTY_STRING).toString())&&(prefixLength>=1&&el.selectionStart>prefixLength||0===prefixLength);)el.setSelectionRange(el.selectionStart-1,el.selectionEnd)}this.checkSelectionOnDeletion(el),this._maskService.prefix.length&&el.selectionStart<=this._maskService.prefix.length&&el.selectionEnd<=this._maskService.prefix.length&&e.preventDefault();const cursorStart=el.selectionStart;e.key!==MaskExpression.BACKSPACE||el.readOnly||0!==cursorStart||el.selectionEnd!==el.value.length||0===el.value.length||(this._position.set(this._maskService.prefix?this._maskService.prefix.length:0),this._maskService.applyMask(this._maskService.prefix,this._maskService.maskExpression,this._position()))}this.suffix()&&this.suffix().length>1&&this._inputValue().length-this.suffix().length<el.selectionStart?el.setSelectionRange(this._inputValue().length-this.suffix().length,this._inputValue().length):("KeyA"===e.code&&e.ctrlKey||"KeyA"===e.code&&e.metaKey)&&(el.setSelectionRange(0,this._getActualInputLength()),e.preventDefault()),this._maskService.selStart=el.selectionStart,this._maskService.selEnd=el.selectionEnd}}writeValue(controlValue){var _this=this;return(0,C_Users_thiago_bloomfield_Documents_SaluxTech_sx_lib_front_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_2__.A)((function*(){let value=controlValue;const inputTransformFn=_this.inputTransformFn();if("object"==typeof value&&null!==value&&"value"in value&&("disable"in value&&_this.setDisabledState(Boolean(value.disable)),value=value.value),null!==value&&(value=inputTransformFn?inputTransformFn(value):value),"string"==typeof value||"number"==typeof value||null==value){null!=value&&""!==value||(_this._maskService.currentValue="",_this._maskService.previousValue="");let inputValue=value;if("number"==typeof inputValue||_this._maskValue().startsWith(MaskExpression.SEPARATOR)){inputValue=String(inputValue);const localeDecimalMarker=_this._maskService.currentLocaleDecimalMarker();Array.isArray(_this._maskService.decimalMarker)||(inputValue=_this._maskService.decimalMarker!==localeDecimalMarker?inputValue.replace(localeDecimalMarker,_this._maskService.decimalMarker):inputValue),_this._maskService.leadZero&&inputValue&&_this.mask()&&!1!==_this.dropSpecialCharacters()&&(inputValue=_this._maskService._checkPrecision(_this._maskService.maskExpression,inputValue)),(_this._maskService.decimalMarker===MaskExpression.COMMA||Array.isArray(_this._maskService.decimalMarker)&&_this._maskService.thousandSeparator===MaskExpression.DOT)&&(inputValue=inputValue.toString().replace(MaskExpression.DOT,MaskExpression.COMMA)),_this.mask()?.startsWith(MaskExpression.SEPARATOR)&&_this.leadZero()&&requestAnimationFrame((()=>{_this._maskService.applyMask(inputValue?.toString()??"",_this._maskService.maskExpression)})),_this._maskService.isNumberValue=!0}"string"==typeof inputValue&&null!=value||(inputValue=""),_this._inputValue.set(inputValue),_this._setMask(),inputValue&&_this._maskService.maskExpression||_this._maskService.maskExpression&&(_this._maskService.prefix||_this._maskService.showMaskTyped)?("function"!=typeof inputTransformFn&&(_this._maskService.writingValue=!0),_this._maskService.formElementProperty=["value",_this._maskService.applyMask(inputValue,_this._maskService.maskExpression)],"function"!=typeof inputTransformFn&&(_this._maskService.writingValue=!1)):_this._maskService.formElementProperty=["value",inputValue],_this._inputValue.set(inputValue)}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof value)}))()}registerOnChange(fn){this._maskService.onChange=this.onChange=fn}registerOnTouched(fn){this.onTouch=fn}_getActiveElement(document=this.document){const shadowRootEl=document?.activeElement?.shadowRoot;return shadowRootEl?.activeElement?this._getActiveElement(shadowRootEl):document.activeElement}checkSelectionOnDeletion(el){const prefixLength=this.prefix().length,suffixLength=this.suffix().length,inputValueLength=this._inputValue().length;el.selectionStart=Math.min(Math.max(prefixLength,el.selectionStart),inputValueLength-suffixLength),el.selectionEnd=Math.min(Math.max(prefixLength,el.selectionEnd),inputValueLength-suffixLength)}setDisabledState(isDisabled){this._maskService.formElementProperty=["disabled",isDisabled]}_applyMask(){this._maskService.maskExpression=this._maskService._repeatPatternSymbols(this._maskValue()||""),this._maskService.formElementProperty=["value",this._maskService.applyMask(this._inputValue(),this._maskService.maskExpression)]}_validateTime(value){const rowMaskLen=this._maskValue().split(MaskExpression.EMPTY_STRING).filter((s=>":"!==s)).length;return value&&(0==+(value[value.length-1]??-1)&&value.length<rowMaskLen||value.length<=rowMaskLen-2)?this._createValidationError(value):null}_getActualInputLength(){return this._maskService.actualValue.length||this._maskService.actualValue.length+this._maskService.prefix.length}_createValidationError(actualValue){return{mask:{requiredMask:this._maskValue(),actualValue}}}_setMask(){this._maskExpressionArray().some((mask=>{if(mask.split(MaskExpression.EMPTY_STRING).some((char=>this._maskService.specialCharacters.includes(char)))&&this._inputValue()&&this._areAllCharactersInEachStringSame(this._maskExpressionArray())||mask.includes(MaskExpression.CURLY_BRACKETS_LEFT)){const test=this._maskService.removeMask(this._inputValue())?.length<=this._maskService.removeMask(mask)?.length;if(test){const maskValue=mask.includes(MaskExpression.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(mask):mask;return this._maskValue.set(maskValue),this._maskService.maskExpression=maskValue,test}{const expression=this._maskExpressionArray()[this._maskExpressionArray().length-1]??MaskExpression.EMPTY_STRING,maskValue=expression.includes(MaskExpression.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(expression):expression;this._maskValue.set(maskValue),this._maskService.maskExpression=maskValue}}else{const cleanMask=this._maskService.removeMask(mask),check=this._maskService.removeMask(this._inputValue())?.split(MaskExpression.EMPTY_STRING).every(((character,index)=>{const indexMask=cleanMask.charAt(index);return this._maskService._checkSymbolMask(character,indexMask)}));if(check||this._justPasted())return this._maskValue.set(mask),this._maskService.maskExpression=mask,check}}))}_areAllCharactersInEachStringSame(array){const specialCharacters=this._maskService.specialCharacters;return array.map((function removeSpecialCharacters(str){const regex=new RegExp(`[${specialCharacters.map((ch=>`\\${ch}`)).join("")}]`,"g");return str.replace(regex,"")})).every((str=>1===new Set(str).size))}static ɵfac=function NgxMaskDirective_Factory(__ngFactoryType__){return new(__ngFactoryType__||NgxMaskDirective)};static ɵdir=_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineDirective"]({type:NgxMaskDirective,selectors:[["input","mask",""],["textarea","mask",""]],hostBindings:function NgxMaskDirective_HostBindings(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵlistener"]("paste",(function NgxMaskDirective_paste_HostBindingHandler(){return ctx.onPaste()}))("focus",(function NgxMaskDirective_focus_HostBindingHandler($event){return ctx.onFocus($event)}))("ngModelChange",(function NgxMaskDirective_ngModelChange_HostBindingHandler($event){return ctx.onModelChange($event)}))("input",(function NgxMaskDirective_input_HostBindingHandler($event){return ctx.onInput($event)}))("compositionstart",(function NgxMaskDirective_compositionstart_HostBindingHandler($event){return ctx.onCompositionStart($event)}))("compositionend",(function NgxMaskDirective_compositionend_HostBindingHandler($event){return ctx.onCompositionEnd($event)}))("blur",(function NgxMaskDirective_blur_HostBindingHandler($event){return ctx.onBlur($event)}))("click",(function NgxMaskDirective_click_HostBindingHandler($event){return ctx.onClick($event)}))("keydown",(function NgxMaskDirective_keydown_HostBindingHandler($event){return ctx.onKeyDown($event)}))},inputs:{mask:[1,"mask"],specialCharacters:[1,"specialCharacters"],patterns:[1,"patterns"],prefix:[1,"prefix"],suffix:[1,"suffix"],thousandSeparator:[1,"thousandSeparator"],decimalMarker:[1,"decimalMarker"],dropSpecialCharacters:[1,"dropSpecialCharacters"],hiddenInput:[1,"hiddenInput"],showMaskTyped:[1,"showMaskTyped"],placeHolderCharacter:[1,"placeHolderCharacter"],shownMaskExpression:[1,"shownMaskExpression"],clearIfNotMatch:[1,"clearIfNotMatch"],validation:[1,"validation"],separatorLimit:[1,"separatorLimit"],allowNegativeNumbers:[1,"allowNegativeNumbers"],leadZeroDateTime:[1,"leadZeroDateTime"],leadZero:[1,"leadZero"],triggerOnMaskChange:[1,"triggerOnMaskChange"],apm:[1,"apm"],inputTransformFn:[1,"inputTransformFn"],outputTransformFn:[1,"outputTransformFn"],keepCharacterPositions:[1,"keepCharacterPositions"],instantPrefix:[1,"instantPrefix"]},outputs:{maskFilled:"maskFilled"},exportAs:["mask","ngxMask"],features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵProvidersFeature"]([{provide:_angular_forms__WEBPACK_IMPORTED_MODULE_3__.kq,useExisting:NgxMaskDirective,multi:!0},{provide:_angular_forms__WEBPACK_IMPORTED_MODULE_3__.cz,useExisting:NgxMaskDirective,multi:!0},NgxMaskService]),_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵNgOnChangesFeature"]]})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵsetClassMetadata"](NgxMaskDirective,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Directive,args:[{selector:"input[mask], textarea[mask]",standalone:!0,providers:[{provide:_angular_forms__WEBPACK_IMPORTED_MODULE_3__.kq,useExisting:NgxMaskDirective,multi:!0},{provide:_angular_forms__WEBPACK_IMPORTED_MODULE_3__.cz,useExisting:NgxMaskDirective,multi:!0},NgxMaskService],exportAs:"mask,ngxMask"}]}],null,{onPaste:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.HostListener,args:["paste"]}],onFocus:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.HostListener,args:["focus",["$event"]]}],onModelChange:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.HostListener,args:["ngModelChange",["$event"]]}],onInput:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.HostListener,args:["input",["$event"]]}],onCompositionStart:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.HostListener,args:["compositionstart",["$event"]]}],onCompositionEnd:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.HostListener,args:["compositionend",["$event"]]}],onBlur:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.HostListener,args:["blur",["$event"]]}],onClick:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.HostListener,args:["click",["$event"]]}],onKeyDown:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.HostListener,args:["keydown",["$event"]]}]});class NgxMaskPipe{defaultOptions=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(NGX_MASK_CONFIG);_maskService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(NgxMaskService);_maskExpressionArray=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.signal)([]);_mask=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.signal)("");transform(value,mask,{patterns,...config}={}){let processedValue=value;const currentConfig={maskExpression:mask,...this.defaultOptions,...config,patterns:{...this._maskService.patterns,...patterns}};if(Object.entries(currentConfig).forEach((([key,val])=>{this._maskService[key]=val})),mask.includes("||")){const maskParts=mask.split("||");return maskParts.length>1?(this._maskExpressionArray.set(maskParts.sort(((a,b)=>a.length-b.length))),this._setMask(processedValue),this._maskService.applyMask(`${processedValue}`,this._mask())):(this._maskExpressionArray.set([]),this._maskService.applyMask(`${processedValue}`,this._mask()))}if(mask.includes(MaskExpression.CURLY_BRACKETS_LEFT))return this._maskService.applyMask(`${processedValue}`,this._maskService._repeatPatternSymbols(mask));if(mask.startsWith(MaskExpression.SEPARATOR)){config.decimalMarker&&(this._maskService.decimalMarker=config.decimalMarker),config.thousandSeparator&&(this._maskService.thousandSeparator=config.thousandSeparator),config.leadZero&&(this._maskService.leadZero=config.leadZero),processedValue=String(processedValue);const localeDecimalMarker=this._maskService.currentLocaleDecimalMarker();Array.isArray(this._maskService.decimalMarker)||(processedValue=this._maskService.decimalMarker!==localeDecimalMarker?processedValue.replace(localeDecimalMarker,this._maskService.decimalMarker):processedValue),this._maskService.leadZero&&processedValue&&!1!==this._maskService.dropSpecialCharacters&&(processedValue=this._maskService._checkPrecision(mask,processedValue)),this._maskService.decimalMarker===MaskExpression.COMMA&&(processedValue=processedValue.replace(MaskExpression.DOT,MaskExpression.COMMA)),this._maskService.isNumberValue=!0}return null==processedValue?this._maskService.applyMask("",mask):this._maskService.applyMask(`${processedValue}`,mask)}_setMask(value){this._maskExpressionArray().length>0&&this._maskExpressionArray().some((mask=>{const test=this._maskService.removeMask(value)?.length<=this._maskService.removeMask(mask)?.length;if(value&&test)return this._mask.set(mask),test;{const expression=this._maskExpressionArray()[this._maskExpressionArray.length-1]??MaskExpression.EMPTY_STRING;this._mask.set(expression)}}))}static ɵfac=function NgxMaskPipe_Factory(__ngFactoryType__){return new(__ngFactoryType__||NgxMaskPipe)};static ɵpipe=_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefinePipe"]({name:"mask",type:NgxMaskPipe,pure:!0})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵsetClassMetadata"](NgxMaskPipe,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Pipe,args:[{name:"mask",pure:!0,standalone:!0}]}],null,null)}}]);